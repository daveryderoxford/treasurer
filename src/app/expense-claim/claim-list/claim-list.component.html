<app-toolbar title="IBRSC - Expenses" showBack="false">
   <a mat-flat-button [routerLink]="['/claims/add']">
      <mat-icon>add</mat-icon> New
   </a>
   <app-auth-button></app-auth-button>
</app-toolbar>

<div>
   <mat-form-field appearance="outline" subscriptSizing='dynamic' class="full-width">
      <mat-icon matPrefix>search</mat-icon>
      <input #searchQuery matInput placeholder="Search" (input)="searchKeyPressed(searchQuery.value)">
   </mat-form-field>
</div>


<app-list-container>
   <mat-list>
      <mat-list-item *ngFor="let claim of filteredClaims()">
         <span matListItemTitle>
            <span class=gap>{{claim.id}}</span>
            <span class=gap>{{claim.dateSubmitted | date}}</span>
            @if (auth.isTreasurer()) {
            <span class=gap>{{claim.name}}</span>
            }
            <span class=gap>Â£{{claim.amount | number: '1.2-2'}}</span>
         </span>
         <span matListItemLine>
            <b class="gap"> {{claim.state}}</b>
            @if (claim.state === 'Error' || claim.state === 'Cancelled' || claim.state === 'Rejected') {
            {{claim.reason}}
            } @else {
            {{claim.attachments.length.toString()}} attachemnts
            }
         </span>
         <span matListItemLine> {{claim.description}}</span>

         @if (auth.isTreasurer() || claim.state === 'Submitted') {
         <button mat-icon-button matListItemMeta color="primary" (click)="edit(claim)">
            <mat-icon>edit</mat-icon>
         </button>
         }
         <mat-divider></mat-divider>

      </mat-list-item>
   </mat-list>
   <app-claim-summary [claims]="filteredClaims()"></app-claim-summary>
</app-list-container>